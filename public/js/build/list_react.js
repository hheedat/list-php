!function(t){function e(i){if(a[i])return a[i].exports;var s=a[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";var i=a(1),s=a(5),n=a(2);dispacher.list=new i;var l=React.createClass({displayName:"ListShow",timer:null,getInitialState:function(){return{data:[]}},loadDataFromServer:function(){return dispacher.list.trigger("show-loading"),$.ajax({url:this.props.url,dataType:"json",method:"post"}).done(function(t){"succ"==t.type?this.updateList(t):alert("出现了一些错误 : "+t.msg)}.bind(this)).fail(function(t,e,a){alert("网络出现了一些问题"),console.error(this.props.url,e,a)}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},updateList:function(t){return t?void this.setState({data:t.msg}):!1},componentDidMount:function(){dispacher.list.on("update-list",this.loadDataFromServer),this.loadDataFromServer().then(function(){dispacher.list.trigger("update-input-width")}),this.timer=setInterval(this.loadDataFromServer,this.props.pollInterval)},componentWillUnmount:function(){dispacher.list.off("update-list",this.loadDataFromServer),clearInterval(this.timer)},render:function(){return React.createElement("div",{className:"list-wrapper"},React.createElement("div",{className:"list-head"},React.createElement("span",null)),React.createElement(r,{data:this.state.data,urlItemComplete:"/list/complete",urlItemUndo:"/list/undo"}))}}),r=React.createClass({displayName:"ListCon",changeItemStatus:function(t){t.stopPropagation();var e=t.target.checked?this.props.urlItemComplete:this.props.urlItemUndo;return dispacher.list.trigger("show-loading"),$.ajax({url:e,dataType:"json",method:"post",data:{id:t.target.getAttribute("data-id")}}).done(function(t){"succ"==t.type?dispacher.list.trigger("update-list"):alert("出现了一些错误 : "+t.msg)}).fail(function(t,e,a){alert("网络出现了一些问题"),console.error(this.props.url,e,a)}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},checkItemDetail:function(t){dispacher.list.trigger("show-list-detail",t)},render:function(){var t=this,e=this.props.data.map(function(e){return React.createElement("div",{className:"list-item cf",key:e.id,onClick:t.checkItemDetail.bind(t,e.id)},React.createElement("input",{type:"checkbox","data-id":e.id,onClick:t.changeItemStatus,defaultChecked:e.status?!1:!0}),React.createElement("span",{className:"list-title"},e.title),React.createElement("span",{className:"list-time"},moment().date()!=moment(e.time).date()?moment().format("l"):moment(e.time).startOf("second").fromNow()))});return React.createElement("div",{className:"list-data"},e)}}),o=React.createClass({displayName:"ListAdd",getInitialState:function(){return dispacher.list.on("update-input-width",this.setInputWidth),{inputWidth:null}},componentDidMount:function(){this.setInputWidth(),window.addEventListener("resize",this.handleResize)},setInputWidth:function(){var t=this.refs.title.getDOMNode(),e=this.refs.addBtn.getDOMNode();this.setState({inputWidth:parseInt(getComputedStyle(t.parentNode).width)-parseInt(e.offsetWidth)-35+"px"})},addList:function(t){var e=this.refs.title.getDOMNode().value.trim();e&&(this.submitList({title:e}),this.refs.title.getDOMNode().value="")},handleResize:function(){this.setInputWidth()},handleKeyDown:function(t){13===t.keyCode&&this.addList()},submitList:function(t){return dispacher.list.trigger("show-loading"),$.ajax({url:this.props.url,dataType:"json",type:"post",data:t}).done(function(t){"succ"==t.type?dispacher.list.trigger("update-list"):alert("出现了一些错误"+t.msg)}.bind(this)).fail(function(t,e,a){console.error(this.props.url,e,a),alert("网络出现了一些问题")}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},componentWillUnmount:function(){window.removeEventListener("resize",this.handleResize)},render:function(){return React.createElement("div",{className:"list-add cf"},React.createElement("input",{type:"text",className:"text-input",ref:"title",style:{width:this.state.inputWidth},onKeyDown:this.handleKeyDown,placeholder:"add new list ..."}),React.createElement("button",{ref:"addBtn",className:"add",onClick:this.addList},"add"))}}),c=React.createClass({displayName:"ListDetail",dataID:null,getInitialState:function(){return dispacher.list.on("show-list-detail",this.loadDataFromServer),{data:null}},componentDidMount:function(){},loadDataFromServer:function(t,e){return this.dataID=e,dispacher.list.trigger("show-loading"),$.ajax({url:this.props.urlCheck,dataType:"json",type:"POST",data:{id:e}}).done(function(t){"succ"==t.type?(this.updateList(t),setTimeout(function(){$(this.refs.mask.getDOMNode()).addClass("list-detail-mask-show"),$(this.refs.wrapper.getDOMNode()).addClass("list-detail-wrapper-show")}.bind(this),100)):alert("出现了一些错误"+t.msg)}.bind(this)).fail(function(t,e,a){console.error(this.props.url,e,a),alert("网络出现了一些问题")}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},updateList:function(t){return t?void this.setState({data:t.msg}):!1},updateData:function(){var t=this,e=this.refs.title.getDOMNode().value.trim(),a=this.refs.content.getDOMNode().value.trim();if(!e)return void alert("title can not be null");dispacher.list.trigger("show-loading");var i=$.ajax({url:this.props.urlUpdate,dataType:"json",method:"post",data:{id:this.dataID,title:e,content:a}});i.done(function(e){"succ"==e.type?(t.closeDetail(),dispacher.list.trigger("update-list")):alert("出现了一些错误"+e.msg)}).fail(function(t,e,a){console.error(this.props.url,e,a),alert("网络出现了一些问题")}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},deleteData:function(t){t.preventDefault();var e=this;return dispacher.list.trigger("show-loading"),$.ajax({url:this.props.urlDelete,dataType:"json",method:"post",data:{id:this.dataID}}).done(function(t){"succ"==t.type?(e.closeDetail(),dispacher.list.trigger("update-list")):alert("出现了一些错误"+t.msg)}).fail(function(t,e,a){console.error(this.props.url,e,a),alert("网络出现了一些问题")}.bind(this)).always(function(){dispacher.list.trigger("hide-loading")})},closeDetail:function(t){(!t||t.target.className.match(/list-detail-mask/)||"close-btn"==t.target.className)&&($(this.refs.mask.getDOMNode()).removeClass("list-detail-mask-show"),$(this.refs.wrapper.getDOMNode()).removeClass("list-detail-wrapper-show"),setTimeout(function(){this.setState({data:null})}.bind(this),100))},render:function(){var t=null;return this.state.data&&(t=React.createElement("div",{className:"list-detail-mask",ref:"mask",onClick:this.closeDetail},React.createElement("div",{className:"list-detail-wrapper",ref:"wrapper"},React.createElement("div",{className:"list-detail"},React.createElement("div",{className:"list-control cf"},React.createElement("button",{className:"update-btn",onClick:this.updateData},"update"),React.createElement("button",{className:"close-btn",onClick:this.closeDetail},"close")),React.createElement("div",{className:"list-detail-data"},React.createElement("textarea",{className:"my-textarea",ref:"title",defaultValue:this.state.data.title}),React.createElement("input",{type:"text",className:"text-input",ref:"time",disabled:"disabled",value:moment(this.state.data.time).format("YYYY-MM-DD HH:mm:ss")}),React.createElement("div",{className:"content"},React.createElement("textarea",{className:"my-textarea",ref:"content",style:{height:.8*window.innerHeight-220},defaultValue:this.state.data.content}))),React.createElement("a",{className:"del-btn",onClick:this.deleteData},"delete"))))),React.createElement("div",null,t)}}),d=React.createClass({displayName:"ListShowComplete",isShow:!1,toggleShow:function(){this.isShow?(this.isShow=!1,this.forceUpdate()):(this.isShow=!0,this.forceUpdate())},render:function(){var t=this.isShow?React.createElement("div",{id:"list-complete-show"},React.createElement(l,{url:"/list/check/complete",pollInterval:36e5})):null;return React.createElement("div",{id:"list-complete"},React.createElement("div",{className:"show-complete"},React.createElement("a",{className:"show-complete-toggle",onClick:this.toggleShow,href:"javascript:void(0);"},this.isShow?"HIDE COMPLETED ITEMS":"SHOW COMPLETED ITEMS")),t)}}),u=React.createClass({displayName:"List",render:function(){return React.createElement("div",{className:"list"},React.createElement(n,null),React.createElement(o,{url:"/list/add"}),React.createElement(l,{url:"/list/check/undo",pollInterval:36e5}),React.createElement(c,{urlCheck:"/list/detail",urlUpdate:"/list/update",urlDelete:"/list/delete"}),React.createElement(d,null))}});React.initializeTouchEvents(!0),React.render(React.createElement(u,null),document.getElementById("list-con")),React.render(React.createElement(s,{updateInterval:36e5}),document.getElementById("last-update"))},function(t,e){"use strict";window.Dispatcher=function(){$.extend(this,$({}))},window.dispacher={};t.exports=Dispatcher},function(t,e){"use strict";var a=React.createClass({displayName:"LoadingBar",getInitialState:function(){return{className:"loading"}},componentDidMount:function(){dispacher.list.on("show-loading",this.show),dispacher.list.on("hide-loading",this.hide)},show:function(){this.setState({className:"loading is-loading"})},hide:function(){this.setState({className:"loading is-loading loading-complete"}),dispacher.list.trigger("last-update-time")},render:function(){return React.createElement("div",{className:"loading-bar"},React.createElement("div",{ref:"loadingBar",className:this.state.className}))}});t.exports=a},,,function(t,e){"use strict";var a=React.createClass({displayName:"LastUpdateTime",timer:null,lastUpdateTime:null,getInitialState:function(){return dispacher.list.on("last-update-time",this.newTime),this.lastUpdateTime=moment(),{time:null}},newTime:function(){this.lastUpdateTime=moment(),this.updateTime()},updateTime:function(){this.setState({time:moment(this.lastUpdateTime).format("MM-DD HH:mm:ss")})},componentDidMount:function(){this.timer=setInterval(function(){this.updateTime()}.bind(this),this.props.updateInterval)},componentWillUnmount:function(){clearInterval(this.timer)},render:function(){return React.createElement("span",null,this.state.time?"LAST SYNC："+this.state.time:"")}});t.exports=a}]);